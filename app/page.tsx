"use client"

import { fetchLogin } from "@/app/apis/pomodoro"
import { usePathname, useRouter } from "next/navigation"
import { useContext } from "react"
import { AuthUserContext } from "./context/authUserContext"
import { SERVICE_NAME } from "./utils/constants"

export default function Home() {
  const { isAuthenticated, setIsAuthenticated } = useContext(AuthUserContext)
  const router = useRouter()
  const pathname = usePathname()
  // const [isLogin, setIsLogin] = useState(false);

  const handleSignin = async () => {
    await fetchLogin().then((url) => {
      router.push(url)
    })
  }

  const handleGotoDashboard = () => {
    router.push("/dashboard")
  }

  return (
    <>
      <div className="text-6xl font-bold flex items-center justify-center my-10">
        {SERVICE_NAME}
      </div>
      {!isAuthenticated && (
        <>
          <div className="text-xl my-10 text-center leading-10">
            {SERVICE_NAME}
            は、集中して作業するためのタイマーを作成できるサービスです。
            <br />
            作業時間と休憩時間を自由に設定できます。
            <br />
            また作業時間と休憩時間には、ご自身のSpotifyプレイリストを設定して再生することができます。
            <br />
          </div>
          <div className="text-xl my-10 text-center leading-10">
            使用にはSpotifyのアカウントが必要です。
            <br />
            以下のボタンからSpotifyと連携してください。
            <br />
          </div>
          <div className="flex items-center justify-center">
            <button
              onClick={handleSignin}
              className="mr-4 rounded-md  px-8 py-4 text-xl font-semibold shadow-sm ring-1 bg-gray-800 ring-inset ring-gray-300 hover:bg-gray-500"
              role="menuitem"
              id="user-menu-item-0"
            >
              Spotifyと連携して始める
            </button>
          </div>
          <svg
            height="800px"
            width="800px"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 275.353 275.353"
            style={{ fill: "#fff" }}
          >
            <path
              d="M229.784,199.712c27.269,0,45.568-29.692,45.568-57.419c0-20.117-12.418-22.843-24.562-22.843
    c-3.468,0-7.21,0.234-11.167,0.479c-3.195,0.176-6.507,0.332-9.848,0.41l0.039-0.889H1.514c0,42.959,24.132,80.321,59.686,99.49
    C24.787,221.333,0,226.043,0,231.445c0,7.865,51.782,14.196,115.659,14.196s115.649-6.331,115.649-14.196
    c0-5.432-24.904-10.132-61.454-12.516c10.63-5.725,20.263-13.004,28.529-21.641
    C208.026,199.712,219.448,199.712,229.784,199.712z M229.364,128.272c3.683-0.088,7.289-0.244,10.737-0.469
    c3.83-0.205,7.464-0.42,10.698-0.42c11.509,0,16.658,2.159,16.658,14.909c0,23.419-15.466,49.515-37.664,49.515
    c-9.751,0-18.3-0.205-25.285-1.358C218.559,173.196,227.537,151.731,229.364,128.272z M98.982,97.203
    c-0.557-0.547-13.414-13.922,0.156-30.327c16.58-20,0.01-37-0.156-37.166l-3.595,3.595c0.557,0.537,13.414,13.932-0.166,30.327
    c-16.58,20.029-0.01,37.039,0.166,37.195L98.982,97.203z M118.737,97.203c-0.557-0.547-13.414-13.922,0.166-30.327
    c16.56-20,0-37-0.166-37.166l-3.605,3.595c0.557,0.537,13.414,13.932-0.156,30.327c-16.56,20.039-0.01,37.039,0.166,37.205
    L118.737,97.203z M140.251,97.203c-0.557-0.547-13.414-13.922,0.156-30.327c16.57-20,0-37-0.156-37.166l-3.615,3.595
    c0.547,0.537,13.424,13.932-0.166,30.327c-16.56,20.039,0,37.039,0.176,37.205L140.251,97.203z"
            />
          </svg>
          <svg
            height="800px"
            width="800px"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 512 512"
            style={{ fill: "#fff" }}
          >
            <g>
              <g>
                <circle cx="157.016" cy="104.202" r="40.731" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M498.082,250.72h-72.741c3.166-1.727,5.314-5.085,5.314-8.945c0-5.624-4.56-10.184-10.184-10.184H406.16l42.276-85.527
			c2.602-5.263,0.222-11.63-5.185-13.901c-77.325-32.534-124.476-51.938-131.62-54.273c-20.109-5.863-47.182,13.181-59.301,32.611
			c-1.938,3.107-0.68,7.203,2.617,8.708l17.767,8.109c-4.233,9.274-0.146,20.223,9.128,24.456
			c9.274,4.233,20.223,0.146,24.456-9.128l17.769,8.109c3.318,1.515,7.217-0.234,8.292-3.728c3.515-11.416,4.28-25.84,1.715-38.64
			l91.306,38.36l-41.938,84.845h-27.008c-5.624,0-10.184,4.56-10.184,10.184c0,3.86,2.148,7.218,5.314,8.945H312.84
			c3.166-1.727,5.314-5.085,5.314-8.945c0-5.624-4.56-10.184-10.184-10.184h-41.4h-6.147c-1.411-7.565-7.481-13.739-15.521-14.887
			l-2.546-0.363c-8.45-17.123-8.321-16.861-16.923-34.288c-2.489-5.044-8.598-7.115-13.639-4.625
			c-5.043,2.489-7.113,8.596-4.625,13.64c3.615,7.325,7.181,14.549,10.753,21.786l-41.18-5.878l-42.846-36.547l27.467,13.3
			c-0.707-16.496-14.231-29.46-30.648-29.578l-28.427-0.203c-17.184-0.123-31.171,13.811-31.124,30.986l0.287,104.811
			c0.022,8.221,3.319,16.094,9.163,21.877c4.123,4.081,9.275,6.877,14.838,8.152H56.605L30.268,185.794
			c-1.627-8.278-9.657-13.674-17.935-12.042c-8.278,1.627-13.67,9.657-12.043,17.935l28.76,146.31
			c1.408,7.163,7.688,12.329,14.989,12.329h41.611v53.254l-47.168,25.83c-4.933,2.7-6.742,8.889-4.041,13.822
			c2.702,4.934,8.893,6.744,13.823,4.041l47.569-26.049l47.569,26.049c4.926,2.7,11.12,0.896,13.823-4.041
			c2.702-4.933,0.892-11.122-4.041-13.822l-47.168-25.83v-53.254h44.95c8.437,0,15.276-6.839,15.276-15.275
			c0-5.111-2.519-9.623-6.373-12.397l14.214,3.314v100.416c0,12.23,9.914,22.145,22.145,22.145c12.231,0,22.145-9.915,22.145-22.145
			V308.392c0-10.294-7.092-19.23-17.117-21.567l-41.308-9.629l0.129-20.326c-15.379-17.828-44.472-53.529-44.472-53.529
			l41.254,35.188c2.659,2.268,5.908,3.735,9.368,4.23l56.998,8.136c-6.883,1.037-12.258,7.147-11.789,14.626
			c0.457,7.275,6.484,13.037,13.873,13.037h6.769v154.712c0,8.427,6.832,15.259,15.259,15.259h0.061
			c8.427,0,15.259-6.832,15.259-15.259V278.557h198.974v154.713c0,8.427,6.832,15.259,15.259,15.259h0.061
			c8.427,0,15.259-6.832,15.259-15.259V278.557h5.869c7.687,0,13.918-6.231,13.918-13.918
			C512,256.952,505.768,250.72,498.082,250.72z"
                />
              </g>
            </g>
          </svg>
        </>
      )}
      {isAuthenticated && (
        <>
          <div className="text-xl my-10 text-center leading-10">
            Spotifyと連携済みです。
          </div>
          <div className="flex items-center justify-center">
            <button
              onClick={handleGotoDashboard}
              className="mr-4 rounded-md  px-8 py-4 text-xl font-semibold shadow-sm ring-1 bg-gray-800 ring-inset ring-gray-300 hover:bg-gray-500"
              role="menuitem"
              id="user-menu-item-0"
            >
              ダッシュボードに進む
            </button>
          </div>
        </>
      )}
    </>
  )
}
